<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Tailwind CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.16/dist/tailwind.min.css"
      rel="stylesheet">
    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"
      rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.0/font/bootstrap-icons.css"
      rel="stylesheet">
    <title>Full Monte: Football Sim</title>
  </head>
  <body>
    {% include 'header.html' %}

    <div id="loading-spinner"
      style="display: none; text-align: center; background-color: rgba(0, 0, 0, 0.5); padding: 20px; border-radius: 10px; width: 300px; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1000;">
      <div class="loader" style="margin: 0 auto 10px auto;"></div>
      <p style="color: white; font-size: 16px;">Generating analysis. This page
        will autoredirect when complete. No need to hang out for full sims. You'll
        have a custom results link when complete. Results are available for 24
        hours.</p>
      <div id="countdown-timer"
        style="color: white; font-size: 16px; margin-top: 10px;"></div>
    </div>

    <main class="container mx-auto mt-5 bg-white p-8 rounded-lg shadow-md">
      <h1 class="text-4xl font-bold mb-4">Full Monte: Stats Selector</h1>
      <p class="text-xl mb-8">Dive deep into the art and science of football simulations. Discover how we blend data, intuition, and strategy to bring you unparalleled insights.</p>
    
      <!-- Quick Tips Section -->
      <section class="mb-10 p-6 bg-gray-100 rounded-lg shadow-md">
        <h2 class="text-2xl font-bold mb-4">Quick Tips: Feature Selection</h2>
        <p class="text-gray-700">When selecting features, search for those with a strong relationship with the scoring differential. Be cautious with closely related features; consider using combined metrics for more insight.</p>
        <ul class="list-disc list-inside text-gray-700">
          <li>All games are simulated 100 times each for robust analysis.</li>
          <li>'Full Sim' selects a subset of 4352 historical games (~16 seasons worth of games), for balancing accuracy and speed.</li>
          <li>'Quick Sim' selects a subset of 1088 historical games (~4 seasons), for quick stat category evaluations.</li>
        </ul>
      </section>
    
      <!-- Additional content sections -->
    </main>    

    <div class="container mx-auto mt-5 bg-white p-8 rounded-lg shadow-md">

      <h1 class="text-2xl font-bold text-gray-800 mb-4">Select Columns</h1>
      <div class="mb-3">
        <input type="text"
          class="form-control p-2 rounded border border-gray-300 w-full"
          id="searchInput" placeholder="Search columns...">
        <p id="noResults" style="display: none; color: red;">No results found.</p>
      </div>
      <form action="/stats/process_columns" method="POST">
        <!-- Add an input field for quick_test -->
        <input type="hidden" name="quick_test" id="quick_test_input" value="false">


        <div class="mb-3 flex space-x-2">
          <button type="button" class="bg-gray-800 text-white py-2 px-4 rounded"
            id="selectAll">Select All</button>
          <button type="button" class="bg-gray-800 text-white py-2 px-4 rounded"
            id="selectRandom">Random Selection</button>
          <button type="button" class="bg-gray-800 text-white py-2 px-4 rounded"
            id="clearSelection">Clear Selection</button>
        </div>

        <div class="bg-gray-100 p-4 rounded shadow-md mb-4">
          <h5 class="font-bold text-gray-800">Currently Selected Columns:</h5>
          <p id="selectedColumnsList" class="text-gray-700">None</p>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          {% for category, columns in ordered_categorized_columns.items() %}
          <div class="bg-white p-4 rounded shadow-md">
            <div class="flex justify-between items-center mb-2">
              <div class="font-bold text-gray-800">
                {% if category in key_categories %}
                <span class="font-extrabold">{{ category }}</span>
                {% else %}
                {{ category }}
                {% endif %}
              </div>
              <div>
                <input type="checkbox" class="category-select-all"
                  data-category="{{ category }}">
                <label class="text-sm text-gray-600">Select All</label>
              </div>
            </div>
            <div class="space-y-2">
              {% for formatted_column, column in columns|sort(attribute='0') %}
              {% set formatted_column = formatted_column.lower().replace('totals.',
              '').replace('.', ' ').title() %}
              <div class="flex items-center space-x-2 column-container">
                <input class="form-check-input column-checkbox" type="checkbox"
                  name="columns" value="{{ column }}" id="{{ column }}"
                  data-category="{{ category }}"
                  {% if column in active_constants %} checked {% endif %}>
                <label class="form-check-label text-gray-700" for="{{ column }}">
                  {{ formatted_column }}
                </label>
              </div>
              {% endfor %}
            </div>
          </div>
          {% endfor %}
        </div>

        <!-- Fixed Position Button Container -->
        <div
          style="position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); z-index: 1000;">
          <div class="flex justify-center space-x-4 mt-4">
            <button type="button"
              class="bg-green-600 text-white py-2 px-4 rounded"
              id="quickTestButton">Quick Test</button>
            <button type="submit"
              class="bg-blue-600 text-white py-2 px-4 rounded"
              >Full Sim</button>
          </div>
        </div>

      </form>
    </div>

    <!-- Bootstrap JS and dependencies -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <script src="{{ url_for('static', filename='columns.js') }}"></script>

    {% include 'footer.html' %}

  </body>
</html>
